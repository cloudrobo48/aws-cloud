---
layout: default
---

# Lambdaã¸ã®CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

[â† å‰ã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹](/docs/aws-hands-on.html)

## CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹æˆå›³

![CI/CDãƒ•ãƒ­ãƒ¼]({{ site.baseurl }}/images/CICD-Lambda1.jpg)

## CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¦‚è¦èª¬æ˜ï¼ˆAWS Lambdaå…¬é–‹ï¼‰

æœ¬æ§‹æˆã§ã¯ã€GitHub Actionsã‚’ç”¨ã„ãŸCI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã—ã€Pythonã§è¨˜è¿°ã—ãŸAWS Lambdaé–¢æ•°ã‚’è‡ªå‹•çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ä»•çµ„ã¿ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚  
å€‹äººé–‹ç™ºç’°å¢ƒã§ã®æ§‹ç¯‰ã§ã™ãŒã€ãƒãƒ¼ãƒ é–‹ç™ºã‚’æƒ³å®šã—ãŸè¨­è¨ˆã¨å“è³ªç®¡ç†ã‚’æ„è­˜ã—ã¦ã„ã¾ã™ã€‚

### ä¸»ãªæ§‹æˆè¦ç´ 

- **CIï¼ˆç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰**
  - `black`, `flake8`, `isort`, `mypy` ã«ã‚ˆã‚‹é™çš„è§£æã¨ã‚³ãƒ¼ãƒ‰æ•´å½¢ï¼ˆpre-commit hookï¼‰
  - `pytest` ã«ã‚ˆã‚‹ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆPush/Pull Requestæ™‚ã«å®Ÿè¡Œï¼‰
  - GitHub Actionsã«ã‚ˆã‚‹è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

- **CDï¼ˆç¶™ç¶šçš„ãƒ‡ãƒªãƒãƒªãƒ¼ï¼‰**
  - `main`ãƒ–ãƒ©ãƒ³ãƒã¸ã®Pushã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã€GitHub Actionsã§Lambdaã¸è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
  - ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã¯GitHub Secretsã‚’åˆ©ç”¨ã—ã€AWSèªè¨¼æƒ…å ±ã‚’å®‰å…¨ã«ç®¡ç†

### ãƒ•ãƒ­ãƒ¼æ¦‚è¦

1. é–‹ç™ºè€…ãŒ `git commit` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`pre-commit` ãƒ•ãƒƒã‚¯ãŒèµ·å‹•ã—ã€ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ã‚’å®Ÿæ–½
2. `git push` ã«ã‚ˆã‚Š GitHub ä¸Šã§ Push ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ã€CIå‡¦ç†ãŒé–‹å§‹
3. Pull Request ä½œæˆæ™‚ã«ã‚‚ GitHub Actions ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã‚‹
4. PRã‚’ `main` ãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã™ã‚‹ã¨ã€å†åº¦ Push ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ã€Lambda ã¸ã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹
5. ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ GitHub Actions ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†…ã§ AWS Lambda ã«å¯¾ã—ã¦è¡Œã‚ã‚Œã‚‹

### è£œè¶³

- ç¾åœ¨ã¯å€‹äººé–‹ç™ºç’°å¢ƒã®ãŸã‚ã€ã™ã¹ã¦ã®æ“ä½œã¯è‡ªèº«ãŒæ‹…å½“
- å°†æ¥çš„ãªãƒãƒ¼ãƒ é–‹ç™ºã‚’æƒ³å®šã—ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼è€…ãƒ»è²¬ä»»è€…ã®å½¹å‰²ã‚‚å›³ã«åæ˜ äºˆå®š
- Secretsç®¡ç†ã«ã¯ GitHub ã® `Actions secrets` ã‚’ä½¿ç”¨ã—ã€AWSã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ç­‰ã®æ©Ÿå¯†æƒ…å ±ã‚’å®‰å…¨ã«ä¿æŒ

### Slacké€šçŸ¥ã«ã‚ˆã‚‹é‹ç”¨è£œåŠ©ï¼ˆã‚«ã‚¹ã‚¿ãƒ é€šçŸ¥ï¼‰

GitHub Actionsã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†…ã«Slacké€šçŸ¥ã‚¹ãƒ†ãƒƒãƒ—ã‚’çµ„ã¿è¾¼ã¿ã€CI/CDã®å®Ÿè¡Œçµæœã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«è¨­è¨ˆã—ã¦ã„ã¾ã™ã€‚  
Slackã®Incoming Webhookã‚’åˆ©ç”¨ã—ã€GitHub Secretsã«Webhook URLã‚’å®‰å…¨ã«ç™»éŒ²ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸæ™‚ã‚„CIå¤±æ•—æ™‚ãªã©ã€ä»»æ„ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§é€šçŸ¥ã‚’é€ä¿¡å¯èƒ½ã§ã™ã€‚

Slacké€šçŸ¥ã¯ã€é–‹ç™ºè€…ãŒGitHubä¸Šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³çµæœã‚’å³åº§ã«æŠŠæ¡ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—ã®é«˜é€ŸåŒ–ã¨é‹ç”¨åŠ¹ç‡ã®å‘ä¸Šã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚  
å°†æ¥çš„ã«ã¯ã€é€šçŸ¥ãƒãƒ£ãƒ³ãƒãƒ«ã®åˆ†é›¢ã‚„ã€Slack Botã«ã‚ˆã‚‹æ‰¿èªãƒ•ãƒ­ãƒ¼é€£æºãªã©ã‚‚è¦–é‡ã«å…¥ã‚Œã¦ã„ã¾ã™ã€‚

---

> GitHub Actionsã‚’æ´»ç”¨ã—ãŸCI/CDã®è¨­è¨ˆã‹ã‚‰ã€AWS Lambdaã¸ã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§ã‚’ä¸€è²«ã—ã¦æ§‹ç¯‰ã€‚  
> å®Ÿé‹ç”¨ã«è¿‘ã„å½¢ã§ã®å“è³ªç®¡ç†ã¨å…¬é–‹ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚


ğŸ”— GitHub Repository: [lambda-cicd](https://github.com/cloudrobo48/docker-lambda-cd/)

